"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Transform = void 0;
var runtype_1 = require("../runtype");
function Transform(underlying, transformer, options) {
    return runtype_1.create(function (value) {
        var name = options && options.name;
        var validated = underlying.validate(value);
        if (!validated.success)
            return validated;
        try {
            var value_1 = transformer(validated.value);
            return { success: true, value: value_1 };
        }
        catch (error) {
            var message = "Failed transform" + (name ? " of " + name : '') + ": " + error.toString();
            return { success: false, message: message };
        }
    }, {
        tag: 'transform',
        underlying: underlying,
        transformer: transformer,
        name: options && options.name,
    });
}
exports.Transform = Transform;
